<template name="campaignDashboard">

  {{#if isReady "Initiatives" "campaignInsightList"}}
    <div class="row dashboard-initiative-header">
      <a href="/initiatives/{{getInitiative._id}}/homepage"><h5>Initiative & Line Items</h5></a>
      <div class="col s3">
        <p class="center-align border-bottom">Name</p>
        <p class="center-align no-top-margin">{{getInitiative.name}}</p>
      </div>
      <div class="col s3">
        <p class="center-align border-bottom">Agency</p>
        <p class="center-align no-top-margin">{{getInitiative.agency}}</p>
      </div>
      <div class="col s3">
      <p class="center-align border-bottom">Brand</p>
        <p class="center-align no-top-margin">{{getInitiative.brand}}</p>
      </div>
      <div class="col s3">
      <p class="center-align border-bottom">Product</p>
        <p class="center-align no-top-margin">{{getInitiative.product}}</p>
      </div>
    </div>
    <div class="row line-items" style="margin-bottom: -30px; margin-top: -10px;">
      <table class="centered boost-request-table">
        <thead>
          <tr>
            <th>Objective</th>
            <th>Platform</th>
            <th>Deal Type</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Budget</th>
            <th>Start Date</th>
            <th>End Date</th>
            {{#if isInRole "admin"}}
              <th>Cost Plus</th>
              <th>Percent Total</th>
            {{/if}}
          </tr>
        </thead>
        <tbody>
          {{#each getInitiative.lineItems}}
            {{#if budget}}
              <tr>
                <td>{{objective}}</td>
                <td>{{platform}}</td>
                <td>{{dealType}}</td>
                <td>{{number quantity}}</td>
                <td>{{price}}</td>
                <td>{{money budget}}</td>
                <td>{{formatDate startDate}}</td>
                <td>{{formatDate endDate}}</td>
                {{#if isInRole "admin"}}
                  <td>{{costPlusPercent}}%</td>
                  <td>{{percentTotalPercent}}%</td>
                {{/if}}
              </tr>
            {{/if}}
          {{/each}}
        </tbody>
      </table>
    </div>
    <br>

  <div class="container">
    <div class="row">
      {{#with fetchInsights}}
      <h5 class="center-align" style="margin-bottom: 0px;">{{campaign_name}}</h5>
      <p class="center-align" style="margin-bottom: 1em;">Updated: {{timezone inserted}}</p>


{{!--       <div class="col s6 m6 l6 card grey lighten-5">
        <div class="card-content">
          <span class="center-align dash-data">{{campaign_id}}</span><br>
          <span class="">Campaign ID</span>
        </div>
      </div>
      <div class="col s6 m6 l6 card grey lighten-5">
        <div class="card-content">
          <span class="center-align dash-data">{{objectiveText objective}}</span><br>
          <span class="">Objective</span>
        </div>
      </div> --}}

      {{!-- <p class="fancy"><span>Core Stats</span></p> --}}
      {{#if isInRole "admin"}}
        <div class="col s12">
          <p class="fancy" style="margin-bottom: 1em;"><span>Actual Stats</span></p>
        </div>
        <div class="col s6 m4 l3 card grey lighten-5">
          <div class="card-content">
            <span class="center-align dash-data">{{money spend}}</span><br>
            <span class="">Spend</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card {{highlight 'CPM'}}">
          <div class="card-content">
            <span class="center-align dash-data">{{money cpm}}</span><br>
            <span class="">CPM</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card {{highlight 'CPC'}}">
          <div class="card-content">
            <span class="center-align dash-data">{{money cpc}}</span><br>
            <span class="">CPC</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card {{highlight 'CPVV'}}">
          <div class="card-content ">
            <span class="center-align dash-data">{{money cost_per_video_view}}</span><br>
            <span class="">CPVV</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card {{likesObjective}}">
          <div class="card-content ">
            <span class="center-align dash-data">{{money cpl}}</span><br>
            <span class="">CPL</span>
          </div>
        </div>

        <div class="col s6 m4 l3 card">
        <div class="card-content ">
          <span class="center-align dash-data">{{number total_actions}}</span><br>
          <span class="">Total Actions</span>
        </div>
      </div>
      <div class="col s6 m4 l3 card {{highlight 'CPM'}}">
        <div class="card-content">
          <span class="center-align dash-data">{{number impressions}}</span><br>
          <span class="">Impressions</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card {{highlight 'CPC'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{number clicks}}</span><br>
          <span class="">Clicks</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card grey lighten-5">
        <div class="card-content ">
          <span class="center-align dash-data">{{number link_click}}</span><br>
          <span class="">Link Clicks</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card {{highlight 'CPL'}}">
        <div class="card-content">
          <span class="center-align dash-data">{{number like}}</span><br>
          <span class="">Page Likes (New Fans)</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card {{highlight 'CPVV'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{number video_view}}</span><br>
          <span class="">Video Views</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card grey lighten-5">
        <div class="card-content ">
          <span class="center-align dash-data">{{number page_engagement}}</span><br>
          <span class="">Page Engagement</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card grey lighten-5">
        <div class="card-content ">
          <span class="center-align dash-data">{{number post_engagement}}</span><br>
          <span class="">Post Engagement</span>
        </div>
      </div>

      {{else}}
        {{!------------ BELOW IS WHAT CLIENT SEES ------------}}
      <div class='row'>
        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-usd fa-4x" aria-hidden="true"></i>
            </div>
            <div class="col s7 center-align">
              <span class="dash-data">{{clientStatsSpend spend "spend"}}</span>
              <br>
              <span class="dash-label">Spend</span>
            </div>
          </div>
        </div>
        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-eye fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cpm}}</span>
              <p class="dash-label">CPM</p>
              <span class="dash-data">{{number impressions}}</span>
              <p class="dash-label">Impressions</p>
            </div>
          </div>
        </div>

        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-mouse-pointer fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cpc}}</span>
              <p class="dash-label">CPC</p>
              <span class="dash-data">{{number clicks}}</span>
              <p class="dash-label">Clicks</p>
            </div>
          </div>
        </div>

        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-video-camera fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cpvv}}</span>
              <p class="dash-label">CPVV</p>
              <span class="dash-data">{{number video_view}}</span>
              <p class="dash-label">Video View</p>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-thumbs-up fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cpl}}</span>
              <p class="dash-label">CPL</p>
              <span class="dash-data">{{number like}}</span>
              <p class="dash-label">Page Likes</p>
            </div>
          </div>
        </div>

        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-link fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cplc}}</span>
              <p class="dash-label">CP Link Click</p>
              <span class="dash-data">{{number link_click}}</span>
              <p class="dash-label">Link Clicks</p>
            </div>
          </div>
        </div>

        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-file-text fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cppe}}</span>
              <p class="dash-label">CP Post Eng</p>
              <span class="dash-data">{{number post_engagement}}</span>
              <p class="dash-label">Post Engagement</p>
            </div>
          </div>
        </div>

        <div class="col l3 s6">
          <div class="client-dash-card valign-wrapper">
            <div class="col s5 valign center-align client-dash-card-holder" style="padding-top: 15%">
              <i class="fa fa-desktop fa-4x" aria-hidden="true" style="color: black;"></i>
            </div>
            <div class="col s7 center-align dash-flex">
              <span class="dash-data">{{money clientStats.cpta}}</span>
              <p class="dash-label">CP Total Act</p>
              <span class="dash-data">{{number total_actions}}</span>
              <p class="dash-label">Total Actions</p>
            </div>
          </div>
        </div>


      </div>
      {{!-- end of row that holds what client sees --}}

      {{/if}}
{{!--         <div class="col s6 m4 l3 card {{highlight 'CPL'}}">
          <div class="card-content ">
            <span class="center-align dash-data">{{money clientStats.cpl}}</span><br>
            <span class="">CPL</span>
          </div>
        </div> --}}



      {{#if offsite_conversion}}
        <div class="col s6 m4 l3 card grey lighten-5">
          <div class="card-content ">
            <span class="center-align dash-data">{{number offsite_conversion}}</span><br>
            <span class="">Offsite Conversions</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card grey lighten-5">
          <div class="card-content ">
            <span class="center-align dash-data">{{number offsite_conversion_fb_pixel_add_to_cart}}</span><br>
            <span class="">Conv - Add to Cart</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card grey lighten-5">
          <div class="card-content ">
            <span class="center-align dash-data">{{number offsite_conversion_fb_pixel_view_content}}</span><br>
            <span class="">Conv - View Content</span>
          </div>
        </div>
        <div class="col s6 m4 l3 card grey lighten-5">
          <div class="card-content ">
            <span class="center-align dash-data">{{number offsite_conversion_fb_pixel_purchase}}</span><br>
            <span class="">Conv - Purchase</span>
          </div>
        </div>
      {{/if}}
      {{!-- end of conversion stats --}}

    {{!-- Show client stats --}}
    {{#if isInRole "admin"}}
      <div class="col s12">
        <p class="fancy" style="margin-bottom: 1em;"><span>Client Stats</span></p>
      </div>
      <div class="col s6 m4 l3 card grey lighten-5">
        <div class="card-content ">
          <span class="center-align dash-data">{{clientStatsSpend spend "spend"}}</span><br>
          <span class="">Client Spend</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card {{highlight 'CPM'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{money clientStats.cpm}}</span><br>
          <span class="">Client CPM</span>
        </div>
      </div>

      <div class="col s6 m4 l3 card {{highlight 'CPC'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{money clientStats.cpc}}</span><br>
          <span class="">Client CPC</span>
        </div>
      </div>
      <div class="col s6 m4 l3 card {{highlight 'CPL'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{money clientStats.cpl}}</span><br>
          <span class="">Client CPL</span>
        </div>
      </div>
      <div class="col s6 m4 l3 card {{highlight 'CPVV'}}">
        <div class="card-content ">
          <span class="center-align dash-data">{{money clientStats.cpvv}}</span><br>
          <span class="">Client CPVV</span>
        </div>
      </div>
    {{/if}}
  {{/with}}
  </div> {{!-- end of row --}}
  </div>
  {{getAggregate}}
  {{else}}
    <p>Loading...</p>
  {{/if}}

</template>
